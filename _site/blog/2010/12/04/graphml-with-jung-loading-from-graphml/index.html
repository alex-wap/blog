<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8>
        <meta name=viewport content="width=device-width, initial-scale=1.0">
        <meta name=description content="Blog of Emaad Ahmed Manzoor">
        
        <title>
          
            GraphML With JUNG: Importing GraphML | 
          
          Emaad Ahmed Manzoor
        </title>

        <script src=http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js type=text/javascript></script>
        <script>
            MathJax.Hub.Config({
              "HTML-CSS": {
                linebreaks: {
                    automatic: true,
                    width: "70% container"
                },
                styles: {
                    ".MathJax .math": {
                        //"border": "1px solid #ccc",
                        //"margin": "0.1em 0",
                        //"padding": "0.3em",
                        //"vertical-align": "middle"
                    },
                    ".MathJax_Display .math": {
                        "border": "none",
                        "padding": "0",
                    }
                },
                scale: 100
              }
            });
        </script>
                
        <link rel=stylesheet type=text/css href=/css/pure-min.css>
        <link rel=stylesheet type=text/css href=/css/github.css>
        <link rel=stylesheet type=text/css href=/css/styles.css>
        <link rel=stylesheet type=text/css href=/css/font-awesome/css/font-awesome.min.css>
        
        <link rel=alternate type=application/rss+xml title="RSS feed for eyeshalfclosed.com" href="/feed.xml">
    </head>
    <body>
        <div class="container pure-g-r">
            <div class=pure-u-1-4>
                <div class=author-info>
    <img src="/images/author-image.jpeg" class=author-image />
    <h1 class=author-name><a href=/>Emaad Ahmed Manzoor</a></h1>
    <div class=nav>
        <a href="https://github.com/emaadmanzoor"><i class=icon-github-alt></i></a>
        <a href="https://twitter.com/emaadmanzoor"><i class=icon-twitter></i></a>
        <a href="https://linkedin.com/in/emaadmanzoor"><i class=icon-linkedin></a></i>
        <a href="http://feeds.feedburner.com/eyeshalfclosed"><i class=icon-rss></i></a>
    </div>
    <div class=home-nav>
        <ul>
            <li><a href="https://scholar.google.com/citations?user=TcMyxM0AAAAJ">Scholar</a></li>
            <li><a href="/blog/">Blog</a>
                &nbsp;|&nbsp;
                <a href="/jrnl/">jrnl</a></li>
            <li><a href="/projects/">Projects</a>
                &nbsp;|&nbsp;
                <a href="https://github.com/emaadmanzoor">Code</a>
            </li>
            <li><a href="/talks/">Talks</a></li>
            <li><a href="/service/">Service</a></li>
            <li><a href="/teaching/">Teaching</a></li>
            <li>
                <a class=resume-link href="/cv.pdf">CV</a><br/>
                <span class=resume-update>(Updated Mar. '19)</span>
            </li>
        </ul>
    </div>
</div>

            </div>
            <div class=pure-u-3-4>
                <div class=right-column>
                    <div class=post>
    
    <ul class=post-meta>
    
    <li class=publish-time><i class=icon-calendar></i>December 04, 2010</li>
    
        <li>&middot;</li>
        <li><a href="/tags/#jung-ref">#jung</a></li>
    
</ul>

    <h1 class=title-large>GraphML With JUNG: Importing GraphML</h1>
    <div class=content>
        <p>This is a follow up to my  <a href="/blog/2010/12/04/graphml-with-jung-saving/">earlier post</a>
on saving to GraphML using the JUNG library. It would make more sense if you browsed through
that post before reading this one.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="n">BufferedReader</span> <span class="n">fileReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="n">FileReader</span><span class="o">(</span><span class="n">filename</span><span class="o">));</span></code></pre>
</figure>

<p>You first need to read from your file. This snippet creates a standard Java <code class="highlighter-rouge">BufferedReader</code>,
which in turn is fed from a <code class="highlighter-rouge">FileReader</code> that reads from the file specified by the
<code class="highlighter-rouge">String filename</code>.</p>

<p>The problem is, the <code class="highlighter-rouge">GraphMLReader2</code> is just a smart text parser. For it to do anything useful,
you need to specify <code class="highlighter-rouge">Transformers</code> for the vertices, edges, hyperedges and the graph itself.
We pump these transformers into the function reading the graph so it understands what exactly
to do after it reads these different components in from the GraphML file.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="cm">/* Create the Graph Transformer */</span>
<span class="n">Transformer</span><span class="o">&lt;</span><span class="n">GraphMetadata</span><span class="o">,</span> <span class="n">Graph</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;</span> <span class="n">graphTransformer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">GraphMetadata</span><span class="o">,</span> <span class="n">Graph</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Graph</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;</span> <span class="nf">transform</span><span class="o">(</span><span class="n">GraphMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">metadata</span><span class="o">.</span><span class="na">getEdgeDefault</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">metadata</span><span class="o">.</span><span class="na">getEdgeDefault</span><span class="o">().</span><span class="na">DIRECTED</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">DirectedSparseGraph</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">UndirectedSparseGraph</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">};</span></code></pre>
</figure>

<p>This transformer is used to parse the <code class="highlighter-rouge">&lt;graph&gt;</code> tag in my GraphML file and create a new
<code class="highlighter-rouge">Graph</code> (it would really help if you had your GraphML file open at this point to understand
what the transformers are doing). This tag specifies the beginning of your graph, and whether
the graph is directed or undirected. The function <code class="highlighter-rouge">metadata.getEdgeDefault()</code> in this case
returns <code class="highlighter-rouge">"undirected"</code> which is equal to the library-defined constant
<code class="highlighter-rouge">metadata.getEdgeDefault().DIRECTED</code>. So this transformer checks whether the graph in the file
is directed and returns the required <code class="highlighter-rouge">Graph</code> object.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="cm">/* Create the Vertex Transformer */</span>
<span class="n">Transformer</span><span class="o">&lt;</span><span class="n">NodeMetadata</span><span class="o">,</span> <span class="n">MyVertex</span><span class="o">&gt;</span> <span class="n">vertexTransformer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">NodeMetadata</span><span class="o">,</span> <span class="n">MyVertex</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">MyVertex</span> <span class="nf">transform</span><span class="o">(</span><span class="n">NodeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MyVertex</span> <span class="n">v</span> <span class="o">=</span> <span class="n">MyVertexFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">create</span><span class="o">();</span>
        <span class="n">v</span><span class="o">.</span><span class="na">setX</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">parseDouble</span><span class="o">(</span><span class="n">metadata</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"x"</span><span class="o">)));</span>
        <span class="n">v</span><span class="o">.</span><span class="na">setY</span><span class="o">(</span><span class="n">Double</span><span class="o">.</span><span class="na">parseDouble</span><span class="o">(</span><span class="n">metadata</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"y"</span><span class="o">)));</span>
        <span class="k">return</span> <span class="n">v</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">};</span></code></pre>
</figure>

<p>The vertex transformer is slightly more involved. I’ll list out the various parts:</p>

<ul>
  <li><code class="highlighter-rouge">MyVertexFactory</code>: This is my custom <code class="highlighter-rouge">Factory</code> that generates objects of my custom
<code class="highlighter-rouge">MyVertex</code> class.</li>
  <li><code class="highlighter-rouge">MyVertexFactory.getInstance()</code>: This returns an object of the MyVertexFactory class
 that I can now use to access it’s methods.</li>
  <li><code class="highlighter-rouge">v.setX(Double d)/v.setY(Double d)</code>: These are custom functions I’ve defined for my
<code class="highlighter-rouge">MyVertex</code> class that set the <code class="highlighter-rouge">private int x</code> and <code class="highlighter-rouge">private int y</code> properties of the
 current vertex to the specified value.</li>
  <li><code class="highlighter-rouge">metadata.getProperty("x")</code>/<code class="highlighter-rouge">metadata.getProperty("y")</code>: This gets the value of the
 <em>x</em> and <em>y</em> properties that I’ve stored in my GraphML file (we used the <code class="highlighter-rouge">addVertexData</code>
 function in the previous post to save these out).</li>
</ul>

<p>The vertex transformer parses the vertex data from the file and reads in its <em>x</em> and <em>y</em>
coordinates, and then sets these properties on the newly created <code class="highlighter-rouge">MyVertex</code> object.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="cm">/* Create the Edge Transformer */</span>
<span class="n">Transformer</span><span class="o">&lt;</span><span class="n">EdgeMetadata</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;</span> <span class="n">edgeTransformer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">EdgeMetadata</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">MyEdge</span> <span class="nf">transform</span><span class="o">(</span><span class="n">EdgeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MyEdge</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyEdgeFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">create</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">e</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">};</span></code></pre>
</figure>

<p>Similar to the previous transformer, this edge transformer reads in the edge data from the
file and creates a new edge. The <code class="highlighter-rouge">MyEdgeFactory</code> and <code class="highlighter-rouge">getInstance()</code> are analogous to those
just discussed for the <code class="highlighter-rouge">MyVertex</code> class.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="cm">/* Create the Hyperedge Transformer */</span>
<span class="n">Transformer</span><span class="o">&lt;</span><span class="n">HyperEdgeMetadata</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;</span> <span class="n">hyperEdgeTransformer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">HyperEdgeMetadata</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">MyEdge</span> <span class="nf">transform</span><span class="o">(</span><span class="n">HyperEdgeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">MyEdge</span> <span class="n">e</span> <span class="o">=</span> <span class="n">MyEdgeFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">create</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">e</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">};</span></code></pre>
</figure>

<p>This is pretty much the same code as my edge transformer! My graphs didn’t have hyper-edges,
but the GraphMLReader2 definition <em>requires</em> that you specify a hyperedge transformer too.</p>

<p>Finally, you create your graph reader object:</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="cm">/* Create the graphMLReader2 */</span>
<span class="n">GraphMLReader2</span><span class="o">&lt;</span><span class="n">Graph</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;,</span> <span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;</span> <span class="n">graphReader</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GraphMLReader2</span><span class="o">&lt;</span><span class="n">Graph</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;,</span> <span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;(</span><span class="n">fileReader</span><span class="o">,</span> <span class="n">graphTransformer</span><span class="o">,</span> <span class="n">vertexTransformer</span><span class="o">,</span> <span class="n">edgeTransformer</span><span class="o">,</span> <span class="n">hyperEdgeTransformer</span><span class="o">);</span></code></pre>
</figure>

<p>It’s a pretty long statement to create one object, so make sure you’ve got all your angle brackets
in place.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="k">try</span> <span class="o">{</span>
    <span class="cm">/* Get the new graph object from the GraphML file */</span>
    <span class="n">Graph</span> <span class="n">g</span> <span class="o">=</span> <span class="n">graphReader</span><span class="o">.</span><span class="na">readGraph</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">GraphIOException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{}</span></code></pre>
</figure>

<p>Now you have your Graph object! Assuming you’ve worked with simple JUNG Graph objects enough to
want to save them out, you should be able to take it from here.</p>

<p>There is a small catch though; the graph right now will be displayed without any regard to the
<code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code> properties associated with its vertex objects. So you’ll need to specify a
<code class="highlighter-rouge">StaticLayout</code> with a custom transformer, that reads in the x and y properties of each vertex
and places them accordingly on your canvas. You do that like this:</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="n">StaticLayout</span><span class="o">&lt;</span><span class="n">MyVerex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;</span> <span class="n">layout</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StaticLayout</span><span class="o">(</span><span class="n">g</span><span class="o">,</span> <span class="k">new</span> <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">Point2D</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Point2D</span> <span class="nf">transform</span><span class="o">(</span><span class="n">MyVertex</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Point2D</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point2D</span><span class="o">.</span><span class="na">Double</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">getX</span><span class="o">(),</span> <span class="n">v</span><span class="o">.</span><span class="na">getY</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">});</span></code></pre>
</figure>

<p>This transformer is required to convert a vertex object to a <code class="highlighter-rouge">Point2D</code> object that the
layout needs to position its vertices. It creates a new <code class="highlighter-rouge">Point2D</code> object by using my custom
<code class="highlighter-rouge">getX()</code> and <code class="highlighter-rouge">getY()</code> methods that return the x and y properties of the vertex.</p>

    </div>
</div>

                </div>
            </div>
        </div>
    </body>
</html>
