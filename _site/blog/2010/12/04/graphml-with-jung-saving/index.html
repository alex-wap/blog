<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8>
        <meta name=viewport content="width=device-width, initial-scale=1.0">
        <meta name=description content="Blog of Emaad Ahmed Manzoor">
        
        <title>
          
            GraphML With JUNG: Saving Out | 
          
          Emaad Ahmed Manzoor
        </title>

        <script src=http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js type=text/javascript></script>
        <script>
            MathJax.Hub.Config({
              "HTML-CSS": {
                linebreaks: {
                    automatic: true,
                    width: "70% container"
                },
                styles: {
                    ".MathJax .math": {
                        //"border": "1px solid #ccc",
                        //"margin": "0.1em 0",
                        //"padding": "0.3em",
                        //"vertical-align": "middle"
                    },
                    ".MathJax_Display .math": {
                        "border": "none",
                        "padding": "0",
                    }
                },
                scale: 100
              }
            });
        </script>
                
        <link rel=stylesheet type=text/css href=/css/pure-min.css>
        <link rel=stylesheet type=text/css href=/css/github.css>
        <link rel=stylesheet type=text/css href=/css/styles.css>
        <link rel=stylesheet type=text/css href=/css/font-awesome/css/font-awesome.min.css>
        
        <link rel=alternate type=application/rss+xml title="RSS feed for eyeshalfclosed.com" href="/feed.xml">
    </head>
    <body>
        <div class="container pure-g-r">
            <div class=pure-u-1-4>
                <div class=author-info>
    <img src="/images/author-image.jpeg" class=author-image />
    <h1 class=author-name><a href=/>Emaad Ahmed Manzoor</a></h1>
    <div class=nav>
        <a href="https://github.com/emaadmanzoor"><i class=icon-github-alt></i></a>
        <a href="https://twitter.com/emaadmanzoor"><i class=icon-twitter></i></a>
        <a href="https://linkedin.com/in/emaadmanzoor"><i class=icon-linkedin></a></i>
        <a href="http://feeds.feedburner.com/eyeshalfclosed"><i class=icon-rss></i></a>
    </div>
    <div class=home-nav>
        <ul>
            <li><a href="https://scholar.google.com/citations?user=TcMyxM0AAAAJ">Scholar</a></li>
            <li><a href="/blog/">Blog</a>
                &nbsp;|&nbsp;
                <a href="/jrnl/">jrnl</a></li>
            <li><a href="/projects/">Projects</a>
                &nbsp;|&nbsp;
                <a href="https://github.com/emaadmanzoor">Code</a>
            </li>
            <li><a href="/talks/">Talks</a></li>
            <li><a href="/service/">Service</a></li>
            <li><a href="/teaching/">Teaching</a></li>
            <li>
                <a class=resume-link href="/cv.pdf">CV</a><br/>
                <span class=resume-update>(Updated Mar. '19)</span>
            </li>
        </ul>
    </div>
</div>

            </div>
            <div class=pure-u-3-4>
                <div class=right-column>
                    <div class=post>
    
    <ul class=post-meta>
    
    <li class=publish-time><i class=icon-calendar></i>December 04, 2010</li>
    
        <li>&middot;</li>
        <li><a href="/tags/#jung-ref">#jung</a></li>
    
</ul>

    <h1 class=title-large>GraphML With JUNG: Saving Out</h1>
    <div class=content>
        <p>This one of two posts I’m dedicating to saving out to and loading from GraphML using the
JUNG library. These are two parts of a really good library that lack sufficient documentation.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="n">GraphMLWriter</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;</span> <span class="n">graphWriter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GraphMLWriter</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">MyEdge</span><span class="o">&gt;();</span>

<span class="n">PrintWriter</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PrintWriter</span><span class="o">(</span><span class="k">new</span> <span class="n">BufferedWriter</span><span class="o">(</span><span class="k">new</span> <span class="n">FileWriter</span><span class="o">(</span><span class="n">filename</span><span class="o">)));</span></code></pre>
</figure>

<p>You first need to create your writers. The first line of code creates your
<code class="highlighter-rouge">GraphMLWriter</code> with your custom Edge and Vertex classes specified.</p>

<p>The next line creates a standard Java <code class="highlighter-rouge">PrintWriter</code>, which takes in input from a
<code class="highlighter-rouge">BufferedWriter</code>, which in turn is connected to a <code class="highlighter-rouge">FileWriter</code> that writes to the file
specified by the <code class="highlighter-rouge">String filename</code>.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="n">graphWriter</span><span class="o">.</span><span class="na">addVertexData</span><span class="o">(</span><span class="s">"x"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="s">"0"</span><span class="o">,</span>
    <span class="k">new</span> <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">transform</span><span class="o">(</span><span class="n">MyVertex</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">Double</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">graphy</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">getX</span><span class="o">(</span><span class="n">v</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">);</span>

<span class="n">graphWriter</span><span class="o">.</span><span class="na">addVertexData</span><span class="o">(</span><span class="s">"y"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="s">"0"</span><span class="o">,</span>
    <span class="k">new</span> <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">MyVertex</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">transform</span><span class="o">(</span><span class="n">MyVertex</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">Double</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">graphy</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">getY</span><span class="o">(</span><span class="n">v</span><span class="o">));</span>
       <span class="o">}</span>
    <span class="o">}</span>
<span class="o">);</span></code></pre>
</figure>

<p>By default, the XML file generated does not store the X and Y coordinates of the
vertices, so when you load a graph from a file, all the vertices are placed on top
of each other at a single point on the canvas. These are two bits of code that tell
my GraphMLWriter to add this information in to the file it creates.</p>

<p>The <code class="highlighter-rouge">addVertexData</code> function definition looks like this:</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">addVertexData</span> <span class="o">(</span><span class="n">String</span> <span class="n">id</span><span class="o">,</span>
                           <span class="n">String</span> <span class="n">description</span><span class="o">,</span>
                           <span class="n">String</span> <span class="n">default_value</span><span class="o">,</span>
                           <span class="n">Transformer</span><span class="o">&lt;</span><span class="n">V</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">vertex_transformer</span><span class="o">)</span></code></pre>
</figure>

<p>The <code class="highlighter-rouge">id</code> is the string that I want added into my XML file, and is what I will be
using to extract the value while loading my graph from the file. The <code class="highlighter-rouge">description</code>
would describe the new data field you’re adding, I’ve omitted that here. The <code class="highlighter-rouge">default_value</code>
is again a string, and the last argument is what makes it all work.</p>

<p>A <code class="highlighter-rouge">Transformer</code> can be looked as just something that transforms one object into another.
It has an abstract function <code class="highlighter-rouge">transform </code>that every transformer is required to implement.
In this case, the transformer is required to return a <code class="highlighter-rouge">String</code> that is needed by the
GraphMLWriter, and I’ve used my <code class="highlighter-rouge">AbstractLayout graphy.layout</code> to extract the X and Y
coordinates of the vertex and return them as strings to my GraphMLWriter.</p>

<figure class="highlight">
  <pre><code class="language-java" data-lang="java"><span class="n">graphWriter</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">g</span><span class="o">,</span> <span class="n">out</span><span class="o">);</span></code></pre>
</figure>

<p>This final bit of code saves out the <code class="highlighter-rouge">Graph g</code> using the <code class="highlighter-rouge">PrintWriter out</code>.</p>

    </div>
</div>

                </div>
            </div>
        </div>
    </body>
</html>
