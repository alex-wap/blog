<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8>
        <meta name=viewport content="width=device-width, initial-scale=1.0">
        <meta name=description content="Blog of Emaad Ahmed Manzoor">
        
        <title>
          
            Verilog On Linux: Defenestrating Modelsim | 
          
          Emaad Ahmed Manzoor
        </title>

        <script src=http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML.js type=text/javascript></script>
        <script>
            MathJax.Hub.Config({
              "HTML-CSS": {
                linebreaks: {
                    automatic: true,
                    width: "70% container"
                },
                styles: {
                    ".MathJax .math": {
                        //"border": "1px solid #ccc",
                        //"margin": "0.1em 0",
                        //"padding": "0.3em",
                        //"vertical-align": "middle"
                    },
                    ".MathJax_Display .math": {
                        "border": "none",
                        "padding": "0",
                    }
                },
                scale: 100
              }
            });
        </script>
                
        <link rel=stylesheet type=text/css href=/css/pure-min.css>
        <link rel=stylesheet type=text/css href=/css/github.css>
        <link rel=stylesheet type=text/css href=/css/styles.css>
        <link rel=stylesheet type=text/css href=/css/font-awesome/css/font-awesome.min.css>
        
        <link rel=alternate type=application/rss+xml title="RSS feed for eyeshalfclosed.com" href="/feed.xml">
    </head>
    <body>
        <div class="container pure-g-r">
            <div class=pure-u-1-4>
                <div class=author-info>
    <img src="/images/author-image.jpeg" class=author-image />
    <h1 class=author-name><a href=/>Emaad Ahmed Manzoor</a></h1>
    <div class=nav>
        <a href="https://github.com/emaadmanzoor"><i class=icon-github-alt></i></a>
        <a href="https://twitter.com/emaadmanzoor"><i class=icon-twitter></i></a>
        <a href="https://linkedin.com/in/emaadmanzoor"><i class=icon-linkedin></a></i>
        <a href="http://feeds.feedburner.com/eyeshalfclosed"><i class=icon-rss></i></a>
    </div>
    <div class=home-nav>
        <ul>
            <li><a href="https://scholar.google.com/citations?user=TcMyxM0AAAAJ">Scholar</a></li>
            <li><a href="/blog/">Blog</a>
                &nbsp;|&nbsp;
                <a href="/jrnl/">jrnl</a></li>
            <li><a href="/projects/">Projects</a>
                &nbsp;|&nbsp;
                <a href="https://github.com/emaadmanzoor">Code</a>
            </li>
            <li><a href="/talks/">Talks</a></li>
            <li><a href="/service/">Service</a></li>
            <li><a href="/teaching/">Teaching</a></li>
            <li>
                <a class=resume-link href="/cv.pdf">CV</a><br/>
                <span class=resume-update>(Updated Mar. '19)</span>
            </li>
        </ul>
    </div>
</div>

            </div>
            <div class=pure-u-3-4>
                <div class=right-column>
                    <div class=post>
    
    <ul class=post-meta>
    
    <li class=publish-time><i class=icon-calendar></i>February 22, 2011</li>
    
        <li>&middot;</li>
        <li><a href="/tags/#verilog-ref">#verilog</a></li>
    
</ul>

    <h1 class=title-large>Verilog On Linux: Defenestrating Modelsim</h1>
    <div class=content>
        <blockquote>
  <p>Defenestrate <em>/diˈfɛnəˌstreɪt/</em> (verb) : to throw (a person or thing) out of a window.
The word originated from a couple of incidents in Prague, back in the 14th century, when
a bunch of guys stormed in and tossed seven town officials out the window (quite literally).</p>
</blockquote>

<p>This tutorial’s to the victims of the Modelsim user experience, forced to design hardware in
chains and gracefully handle the precious rear end of the popular musty racehorse that’s
Mentor Graphics’ stable-star. If you’re on Linux, freedom’s a nice option.</p>

<p>I’ll walk you through the steps to start coding in Verilog on your Linux box:</p>

<h2 id="install-the-simulator-and-graphing-tools">Install the simulator and graphing tools</h2>

<p>We use the <a href="http://www.icarus.com/eda/verilog/">Icarus Verilog Simulator</a>
and <a href="http://en.wikipedia.org/wiki/GTKWave">GTKWave</a>.</p>

<figure class="highlight">
  <pre><code class="language-console" data-lang="console"><span class="go">sudo apt-get install verilog gtkwave</span></code></pre>
</figure>

<h2 id="code">Code</h2>

<p>Save the following code out into two files: <code class="highlighter-rouge">counter.v</code> and <code class="highlighter-rouge">counter_tb.v</code>.</p>

<figure class="highlight">
  <pre><code class="language-verilog" data-lang="verilog"><span class="c1">// counter.v
</span><span class="k">module</span> <span class="n">counter</span><span class="p">(</span><span class="n">out</span><span class="o">,</span> <span class="n">clk</span><span class="o">,</span> <span class="n">reset</span><span class="p">)</span><span class="o">;</span>

  <span class="k">parameter</span> <span class="n">WIDTH</span> <span class="o">=</span> <span class="mi">8</span><span class="o">;</span>

  <span class="kt">output</span> <span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">]</span> <span class="n">out</span><span class="o">;</span>
  <span class="kt">input</span>            <span class="n">clk</span><span class="o">,</span> <span class="n">reset</span><span class="o">;</span>

  <span class="kt">reg</span> <span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">]</span>   <span class="n">out</span><span class="o">;</span>
  <span class="kt">wire</span>            <span class="n">clk</span><span class="o">,</span> <span class="n">reset</span><span class="o">;</span>

  <span class="k">always</span> <span class="o">@</span><span class="p">(</span><span class="kt">posedge</span> <span class="n">clk</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;=</span> <span class="n">out</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>

  <span class="k">always</span> <span class="o">@</span><span class="n">reset</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">reset</span><span class="p">)</span>
      <span class="k">assign</span> <span class="n">out</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">else</span>
      <span class="k">deassign</span> <span class="n">out</span><span class="o">;</span>

<span class="k">endmodule</span> <span class="c1">// counter
</span>
<span class="c1">// counter_tb.v
</span><span class="k">module</span> <span class="n">test</span><span class="o">;</span>

 <span class="cm">/* Make a reset that pulses once. */</span>
 <span class="kt">reg</span> <span class="n">reset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
 <span class="k">initial</span> <span class="k">begin</span>
 <span class="p">$</span><span class="nb">dumpfile</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="o">;</span><span class="n">test</span><span class="o">.</span><span class="n">vcd</span><span class="o">&amp;</span><span class="n">quot</span><span class="o">;</span><span class="p">)</span><span class="o">;</span>
 <span class="p">$</span><span class="nb">dumpvars</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span><span class="n">test</span><span class="p">)</span><span class="o">;</span>

 <span class="p">#</span> <span class="mi">17</span> <span class="n">reset</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
 <span class="p">#</span> <span class="mi">11</span> <span class="n">reset</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
 <span class="p">#</span> <span class="mi">29</span> <span class="n">reset</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
 <span class="p">#</span> <span class="mi">5</span>  <span class="n">reset</span> <span class="o">=</span><span class="mi">0</span><span class="o">;</span>
 <span class="p">#</span> <span class="mi">513</span> <span class="p">$</span><span class="nb">finish</span><span class="o">;</span>
 <span class="k">end</span>

 <span class="cm">/* Make a regular pulsing clock. */</span>
 <span class="kt">reg</span> <span class="n">clk</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
 <span class="k">always</span> <span class="p">#</span><span class="mi">1</span> <span class="n">clk</span> <span class="o">=</span> <span class="o">!</span><span class="n">clk</span><span class="o">;</span>

 <span class="kt">wire</span> <span class="p">[</span><span class="mi">7</span><span class="o">:</span><span class="mi">0</span><span class="p">]</span> <span class="n">value</span><span class="o">;</span>
 <span class="n">counter</span> <span class="n">c1</span> <span class="p">(</span><span class="n">value</span><span class="o">,</span> <span class="n">clk</span><span class="o">,</span> <span class="n">reset</span><span class="p">)</span><span class="o">;</span>

 <span class="k">initial</span>
 <span class="p">$</span><span class="nb">monitor</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="o">;</span><span class="n">At</span> <span class="kt">time</span> <span class="o">%</span><span class="n">t</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="o">%</span><span class="n">h</span> <span class="p">(</span><span class="o">%</span><span class="mi">0</span><span class="n">d</span><span class="p">)</span><span class="o">&amp;</span><span class="n">quot</span><span class="o">;,</span>
 <span class="p">$</span><span class="kt">time</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">value</span><span class="p">)</span><span class="o">;</span>

<span class="k">endmodule</span> <span class="o">//</span> <span class="n">test</span></code></pre>
</figure>

<h2 id="compile-and-run-the-code">Compile and run the code</h2>

<p>Open a terminal in the same directory and compile the code with this command:</p>

<figure class="highlight">
  <pre><code class="language-console" data-lang="console"><span class="go">iverilog -o dsn counter_tb.v counter.v</span></code></pre>
</figure>

<p>Run the code with this command: <code class="highlighter-rouge">vvp dsn</code></p>

<p>Simulate the generated output with this: <code class="highlighter-rouge">gtkwave test.vcd &amp;</code></p>

<p>Expand <code class="highlighter-rouge">test</code> on the top-left panel and select <code class="highlighter-rouge">c1</code>, then drag the signals from the
bottom-left (wire, reg) to the Signals panel to it’s immediate right. This should get
you out on the right side of the bed with Verilog on Linux. Your next steps lie
<a href="http://iverilog.wikia.com">here</a>. All sample code and instructions are merely distilled
from the extensive documentation at the wiki linked to above.</p>

    </div>
</div>

                </div>
            </div>
        </div>
    </body>
</html>
